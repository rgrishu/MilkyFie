@*@using Milkyfie.AppCode.Reops.Entities;
    @model List<Category>*@

<style>


</style>

<div class="main-container">
    <!-- Row start -->
    <div class="row gutters">
        <div id="frmcat" class="w-100">
            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                <div class="card lobipanel-minimize ">
                    <div class="card-header bg-primary text-white h6">
                        Banner
                    </div>
                    <div class="card-body">
                        <div class="row gutters">
                            <div class="col-xl-4 col-lg col-md-4 col-sm-4 col-12">

                                <div class="form-group">
                                    <label>Back Link</label>
                                    <input type="text" id="txtbacklink" class="form-control" />
                                </div>
                            </div>
                            <div class="col-xl-4 col-lg col-md-4 col-sm-4 col-12">
                                <div class="form-group">
                                    <label>Upload Image</label>
                                    <input type='file' id="bannerupload" class="form-control UploadImage" />
                                    @*  <label for="bannerupload" class="btn btn-secondary btn-sm">Upload User Banner</label>*@
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg col-md-2 col-sm-2 col-12">
                                <div class="form-group">
                                    <label>Is Popup</label>
                                    <br />
                                    <input type='checkbox' style="margin-top:10px" id="chkpopup" />
                                    @*  <label for="bannerupload" class="btn btn-secondary btn-sm">Upload User Banner</label>*@
                                </div>
                            </div>

                            <div class="col-xl-2 col-lglg-2 col-md-2 col-sm-2 col-12">
                                <div class="btn-group">
                                    <button class="btn btn-primary" style="margin-top:20px" id="btnSubmit" type="submit">Submit</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Row start -->
    <div class="table-container">

        <d iv class="table-responsive">
            <table id="" class="table custom-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Banner</th>

                        <th>Back Link</th>
                        <th>Is Popup</th>

                        <th>Is Active</th>

                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
    </div>


</div>


@section scripts{
<script>
    $(document).ready(function () {
        loadBanner();
        $('#btnSubmit').click(function () {
            if ($('#bannerupload').get(0).files.length === 0) {
                Q.notify(-1, "Select a file To Upload");
                return;
            }
            uploadImage();
        })
    });

    var uploadImage = () => {
        Q.preloader.load();
        var formData = new FormData();
        formData.append('file', $("#bannerupload")[0].files[0]);
        formData.append('backlink', $("#txtbacklink").val());
        formData.append('IsPopup',  $('#chkpopup').is(':checked') == true ? true : false);
        $.ajax({
            type: 'POST',
            url: 'UploadBanner',
            processData: false,
            contentType: false,
            data: formData,
            success: function (result) {
                if (result.statusCode === 1) {
                    $('input').val('');
                    Q.notify(result.statusCode, result.responseText);
                    loadBanner();
                } else {
                    Q.notify(result.statusCode, result.responseText);
                }
            },
            statusCode: {
                500: function () {
                    Q.notify(-1, 'Server error');


                },
                0: function () {
                    Q.notify(-1, 'Internet Connection was broke');

                }
            },
            error: function (result) {

                Q.notify(-1, 'An error occured!');
            },
            complete: function () {
                Q.preloader.remove();
                $('.UploadImage').val('');
            }
        });
    };
    function loadBanner() {
        Q.preloader.load();
        $.ajax({
            type: 'post',
            url: 'GetBanner',
            data: '',
            success: function (data) {
                $('tbody').html(data);
                Q.preloader.remove();
            },
            error: function (data) {
                console.log('An error occurred.');
                console.log(data);
                Q.notify(-1, 'An error occurred.');
                Q.preloader.remove();
            },
        });
    }

</script>

}